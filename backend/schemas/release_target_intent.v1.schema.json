{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://xyn.example/schemas/release_target_intent.v1.schema.json",
  "title": "ReleaseTargetIntentV1",
  "type": "object",
  "additionalProperties": false,
  "required": [
    "environment_selector",
    "target_instance_selector",
    "fqdn",
    "extraction_source",
    "confidence"
  ],
  "properties": {
    "environment_selector": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "id": { "type": "string", "minLength": 1 },
        "slug": { "type": "string", "minLength": 1 },
        "name": { "type": "string", "minLength": 1 }
      }
    },
    "target_instance_selector": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "id": { "type": "string", "minLength": 1 },
        "name": { "type": "string", "minLength": 1 }
      }
    },
    "fqdn": { "type": "string", "minLength": 3 },
    "tls_mode": {
      "type": "string",
      "enum": ["none", "nginx+acme", "host-ingress"]
    },
    "dns_provider": {
      "type": "string",
      "enum": ["route53"]
    },
    "runtime": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "type": { "type": "string" },
        "transport": { "type": "string" },
        "mode": { "type": "string" },
        "remote_root": { "type": "string" }
      }
    },
    "notes": {
      "type": "array",
      "items": { "type": "string" },
      "default": []
    },
    "confidence": {
      "type": "number",
      "minimum": 0,
      "maximum": 1
    },
    "extraction_source": {
      "type": "string",
      "enum": ["prompt", "model", "labels"]
    }
  }
}
